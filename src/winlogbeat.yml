########### Winlogbeat Configuration ###########
#
# What: Winlogbeat Logstash Config
# Revised: 04/2019 
#
#======================= Winlogbeat specific options ==========================
winlogbeat.event_logs:
  - name: Application
    ignore_older: 24h
    
  - name: Directory Service
    ignore_older: 24h
    
  - name: System
    ignore_older: 24h
    
  - name: Microsoft-Windows-Sysmon/Operational
    processors:
      - script:
          lang: javascript
          id: sysmon
          file: ${path.home}/module/sysmon/config/winlogbeat-sysmon.js

  - name: Microsoft-Windows-NTLM/Operational
  - name: Microsoft-Windows-PowerShell/Operational
  - name: Microsoft-Windows-TerminalServices-LocalSessionManager/Operational
  - name: Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational
  
  - name: Security
    ignore_older: 12h
    event_id: 1102,4608,4609,4610,4611,4612,4614,4615,4616,4618,4621,4622,4624,4625,4627,4634,4646

  - name: Security
    ignore_older: 12h
    event_id: 4647,4648,4649,4656,4657,4658,4659,4660,4661,4662,4663,4664,4665,4666,4667,4668

  - name: Security
    ignore_older: 12h
    event_id: 4670,4671,4672,4673,4674,4675,4688,4689,4690,4691,4692,4693,4694,4695,4696,4697

  - name: Security
    ignore_older: 12h
    event_id: 4698,4699,4700,4701,4702,4703,4704,4705,4706,4707,4713,4714,4715,4716,4717,4718,4719

  - name: Security
    ignore_older: 12h
    event_id: 4720,4722,4723,4724,4725,4726,4727,4728,4729,4730,4731,4732,4733,4734,4735,4737

  - name: Security
    ignore_older: 12h
    event_id: 4738,4739,4740,4741,4742,4743,4744,4745,4746,4747,4748,4749,4750,4751,4752,4753

  - name: Security
    ignore_older: 12h
    event_id: 4754,4755,4756,4757,4758,4759,4760,4761,4762,4764,4764,4765,4766,4767,4768,4769

  - name: Security
    ignore_older: 12h
    event_id: 4770,4771,4772,4774,4775,4776,4777,4778,4779,4780,4781,4782,4783,4784,4785,4786

  - name: Security
    ignore_older: 12h
    event_id: 4787,4788,4789,4790,4793,4794,4797,4798,4799,4800,4801,4802,4803,4816,4864,4865,4866

  - name: Security
    ignore_older: 12h
    event_id: 4867,4897,4902,4904,4905,4906,4907,4908,4909,4910,4912,4928,4929,4930,4931,4932,4933

  - name: Security
    ignore_older: 12h
    event_id: 4934,4935,4936,4937,4944,4945,4946,4947,4948,4949,4950,4951,4952,4953,4954,4956,4957

  - name: Security
    ignore_older: 12h
    event_id: 4958,4964,4985,5024,5025,5027,5028,5029,5030,5031,5032,5033,5034,5035,5037,5038,5058

  - name: Security
    ignore_older: 12h
    event_id: 5059,5061,5120,5121,5122,5123,5124,5136,5137,5138,5139,5140,5141,5145,5152,5153,5154

  - name: Security
    ignore_older: 12h
    event_id: 5156,5157,5158,5159,5169,5376,5377,5378,5379,5440,5441,5442,5443,5444,5446,5447,5448

  - name: Security
    ignore_older: 12h
    event_id: 5479,5632,5633,5712,5888,5889,5890,6008,6144,6145,6146,6272,6273,6274,6275

  - name: Security
    ignore_older: 12h
    event_id: 24577,24578,24579,24580,24581,24582,24583,24584,24586,24588,24592,24593

  - name: Security
    ignore_older: 12h
    event_id: 24594,24595,24621,6276,6277,6280,5449,5450,6279,5155,5156,6278

#----------------------------- Logstash output --------------------------------
output.logstash:
  # The Logstash hosts
  hosts: ["logstash.example.com:5044"]

  # SSL
  # ssl.certificate_authorities: ["${path.home}/pki/root/ca.pem"]
  # ssl.certificate: "${path.home}/pki/client/cert.pem"
  # ssl.key: "${path.home}/pki/client/cert.key"

#================================ Processors =====================================

# Configure processors to enhance or manipulate events generated by the beat.
tags: ["windows"]
# fields_under_root: true
# fields:
#  env: prod
 
processors:
- add_host_metadata:
    netinfo.enabled: false
    cache.ttl: 5m

#================================ Logging =====================================

# Sets log level. The default log level is info.
# Available log levels are: error, warning, info, debug
#logging.level: debug

# At debug level, you can selectively enable logging only for some components.
# To enable all selectors use ["*"]. Examples of other selectors are "beat",
# "publish", "service".
#logging.selectors: ["*"]
